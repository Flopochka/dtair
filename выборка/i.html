<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CSV to SQL</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>
    <input type="file" id="csvFile" accept=".csv">
    <button onclick="processCSV()">Process CSV</button>
    <pre id="output"></pre>

    <script>
        function processCSV() {
            const fileInput = document.getElementById('csvFile');
            if (fileInput.files.length === 0) {
                alert('Please select a CSV file.');
                return;
            }

            const file = fileInput.files[0];
            Papa.parse(file, {
                delimiter: ";",
                header: true,
                skipEmptyLines: true,
                complete: function(results) {
                    const data = results.data;
                    const uniqueEntries = new Set();
                    const sqlQueries = [];
                    data.forEach((row, index) => {
                        // Cleaning up and formatting the data
                        const num_code = row.num_code;
                        const airline = row.airline;
                        const dest_from = row.from;
                        const dest_to = row.to;
                        const time_taken = row.time_taken.replace('h', ':').replace('m', ':00');
                        
                        // Creating a unique key to ensure no duplicates
                        const uniqueKey = `${num_code}-${airline}-${dest_from}-${dest_to}-${time_taken}`;
                        if (!uniqueEntries.has(uniqueKey)) {
                            uniqueEntries.add(uniqueKey);
                            const sql = `INSERT INTO flights (id, num, airline_id, dest_from, dest_to, time) VALUES (NULL, '${num_code}', '${airline}', '${dest_from}', '${dest_to}', '${time_taken}');`;
                            sqlQueries.push(sql);
                        }
                    });
                    document.getElementById('output').textContent = sqlQueries.join('\n');
                }
            });
        }
    </script>
</body>
</html>